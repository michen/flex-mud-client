<?xml version="1.0" encoding="utf-8"?>
<flexlib:MDIWindow		 
	backgroundColor="0xc0c0c0"
	width="600" height="600"
	showCloseButton="true"
	xmlns:flexlib="http://code.google.com/p/flexlib/"	
	xmlns:mate="http://mate.asfusion.com/"
	xmlns:mx="http://www.adobe.com/2006/mxml"	 	
	name="mapperWindow"		
 	creationComplete="init()"
 	title="{oMap.map_name}"
	paddingLeft="5"
	paddingRight="5"
	paddingBottom="5"
	paddingTop="5" 		 	
>


  <mx:Script>
  <![CDATA[
  	import com.simian.mapper.Room;
  	import com.simian.mapper.MapperEvent;
  	
  	import com.simian.mapper.Map;

  	[Bindable]
	public var oMap : Map;
  
  	[Bindable]
  	public var current_room : Room;
  	
  	public var bMappingEnabled : Boolean = false;
  
  
 	private function init() : void {
 		
 		 updateToggleLabel();
 		
 	} 
 	
 	private function wtf() : void { 		 		
 		trace('wtf'); 		
 	}
 	
 	private function updateToggleLabel() : void {
 		if (bMappingEnabled) toggle_mapper.label = 'stop mapping';
 		else toggle_mapper.label = 'start mapping';
 	}
 	
 	private function toggle_mapping() : void {

		// despatch a mapping start/stop even
    	var mEvent : MapperEvent;       	

 		if (bMappingEnabled){ 
 			bMappingEnabled = false;
 			mEvent = new MapperEvent(MapperEvent.MAPPER_STOP);
 		}
 		else { 
 			bMappingEnabled = true;
 			mEvent = new MapperEvent(MapperEvent.MAPPER_START);
 		}
		dispatchEvent(mEvent);

 		updateToggleLabel();
 	}
 	
 	private function find() : void {
 		
 	}
  
  ]]>  
  </mx:Script>

	<mate:Listener type="{MapperEvent.CHANGE_ROOM}" receive="mapview.changeRoom()" />
	
	<mate:Listener type="{MapperEvent.CHANGE_LAYER}" receive="mapview.changeLayer()" />	

	<mx:HBox>		
		<mx:Button id="toggle_mapper" click="toggle_mapping()" />
		<!-- <mx:Button label="find" /> -->	
	</mx:HBox>
	

	<mapper:MapView 
		xmlns:mapper="com.simian.mapper.*" 		
		map="{oMap}" 
		width="100%" 
		height="100%" 
		id="mapview" 
		current_room="{current_room}"
	/>	
	
	
				
</flexlib:MDIWindow>
